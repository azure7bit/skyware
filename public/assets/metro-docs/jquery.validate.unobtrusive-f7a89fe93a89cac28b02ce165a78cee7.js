/// <reference path="jquery-1.5.1.js" />
/// <reference path="jquery.validate.js" />
/*!
** Unobtrusive validation support library for jQuery and jQuery Validate
** Copyright (C) Microsoft Corporation. All rights reserved.
*/
/*jslint white: true, browser: true, onevar: true, undef: true, nomen: true, eqeqeq: true, plusplus: true, bitwise: true, regexp: true, newcap: true, immed: true, strict: false */
/*global document: false, jQuery: false */
(function(e){function i(e,t,n){e.rules[t]=n,e.message&&(e.messages[t]=e.message)}function s(e){return e.replace(/^\s+|\s+$/g,"").split(/\s*,\s*/g)}function o(e){return e.substr(0,e.lastIndexOf(".")+1)}function u(e,t){return e.indexOf("*.")===0&&(e=e.replace("*.",t)),e}function a(t,n){var r=e(this).find("[data-valmsg-for='"+n[0].name+"']"),i=e.parseJSON(r.attr("data-valmsg-replace"))!==!1;r.removeClass("field-validation-valid").addClass("field-validation-error"),t.data("unobtrusiveContainer",r),i?(r.empty(),t.removeClass("input-validation-error").appendTo(r)):t.hide()}function f(t,n){var r=e(this).find("[data-valmsg-summary=true]"),i=r.find("ul");i&&i.length&&n.errorList.length&&(i.empty(),r.addClass("validation-summary-errors").removeClass("validation-summary-valid"),e.each(n.errorList,function(){e("<li />").html(this.message).appendTo(i)}))}function l(t){var n=t.data("unobtrusiveContainer"),r=e.parseJSON(n.attr("data-valmsg-replace"));n&&(n.addClass("field-validation-valid").removeClass("field-validation-error"),t.removeData("unobtrusiveContainer"),r&&n.empty())}function c(t){var n=e(t),i=n.data(r);return i||(i={options:{errorClass:"input-validation-error",errorElement:"span",errorPlacement:e.proxy(a,t),invalidHandler:e.proxy(f,t),messages:{},rules:{},success:e.proxy(l,t)},attachValidation:function(){n.validate(this.options)},validate:function(){return n.validate(),n.valid()}},n.data(r,i)),i}var t=e.validator,n,r="unobtrusiveValidation";t.unobtrusive={adapters:[],parseElement:function(t,n){var r=e(t),i=r.parents("form")[0],s,o,u;if(!i)return;s=c(i),s.options.rules[t.name]=o={},s.options.messages[t.name]=u={},e.each(this.adapters,function(){var n="data-val-"+this.name,s=r.attr(n),a={};s!==undefined&&(n+="-",e.each(this.params,function(){a[this]=r.attr(n+this)}),this.adapt({element:t,form:i,message:s,params:a,rules:o,messages:u}))}),jQuery.extend(o,{__dummy__:!0}),n||s.attachValidation()},parse:function(n){e(n).find(":input[data-val=true]").each(function(){t.unobtrusive.parseElement(this,!0)}),e("form").each(function(){var e=c(this);e&&e.attachValidation()})}},n=t.unobtrusive.adapters,n.add=function(e,t,n){return n||(n=t,t=[]),this.push({name:e,params:t,adapt:n}),this},n.addBool=function(e,t){return this.add(e,function(n){i(n,t||e,!0)})},n.addMinMax=function(e,t,n,r,s,o){return this.add(e,[s||"min",o||"max"],function(e){var s=e.params.min,o=e.params.max;s&&o?i(e,r,[s,o]):s?i(e,t,s):o&&i(e,n,o)})},n.addSingleVal=function(e,t,n){return this.add(e,[t||"val"],function(r){i(r,n||e,r.params[t])})},t.addMethod("__dummy__",function(e,t,n){return!0}),t.addMethod("regex",function(e,t,n){var r;return this.optional(t)?!0:(r=(new RegExp(n)).exec(e),r&&r.index===0&&r[0].length===e.length)}),n.addSingleVal("accept","exts").addSingleVal("regex","pattern"),n.addBool("creditcard").addBool("date").addBool("digits").addBool("email").addBool("number").addBool("url"),n.addMinMax("length","minlength","maxlength","rangelength").addMinMax("range","min","max","range"),n.add("equalto",["other"],function(t){var n=o(t.element.name),r=t.params.other,s=u(r,n),a=e(t.form).find(":input[name="+s+"]")[0];i(t,"equalTo",a)}),n.add("required",function(e){(e.element.tagName.toUpperCase()!=="INPUT"||e.element.type.toUpperCase()!=="CHECKBOX")&&i(e,"required",!0)}),n.add("remote",["url","type","additionalfields"],function(t){var n={url:t.params.url,type:t.params.type||"GET",data:{}},r=o(t.element.name);e.each(s(t.params.additionalfields||t.element.name),function(i,s){var o=u(s,r);n.data[o]=function(){return e(t.form).find(":input[name='"+o+"']").val()}}),i(t,"remote",n)}),e(function(){t.unobtrusive.parse(document)})})(jQuery);